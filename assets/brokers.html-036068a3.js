import{_ as o,r as l,o as c,c as p,b as s,d as n,a as t,e as a}from"./app-34b88414.js";const i={},u=s("h1",{id:"cluster-configuration",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#cluster-configuration","aria-hidden":"true"},"#"),n(" Cluster configuration")],-1),r=s("code",null,"akhq.connections",-1),k=s("li",null,[s("code",null,"key"),n(": must be an url friendly (letter, number, _, -, ... dot are not allowed here) string to identify your cluster ("),s("code",null,"my-cluster-1"),n(" and "),s("code",null,"my-cluster-2"),n(" is the example above)")],-1),d=s("code",null,"properties",-1),m={href:"https://kafka.apache.org/documentation/#consumerconfigs",target:"_blank",rel:"noopener noreferrer"},v=s("code",null,"bootstrap.servers",-1),h=a("<li><code>schema-registry</code>: <em>(optional)</em><ul><li><code>url</code>: the schema registry url</li><li><code>type</code>: the type of schema registry used, either &#39;confluent&#39; or &#39;tibco&#39;</li><li><code>basic-auth-username</code>: schema registry basic auth username</li><li><code>basic-auth-password</code>: schema registry basic auth password</li><li><code>properties</code>: all the configurations for registry client, especially ssl configuration</li></ul></li><li><code>connect</code>: <em>(optional list, define each connector as an element of a list)</em><ul><li><code>name</code>: connect name</li><li><code>url</code>: connect url</li><li><code>basic-auth-username</code>: connect basic auth username</li><li><code>basic-auth-password</code>: connect basic auth password</li><li><code>ssl-trust-store</code>: /app/truststore.jks</li><li><code>ssl-trust-store-password</code>: trust-store-password</li><li><code>ssl-key-store</code>: /app/truststore.jks</li><li><code>ssl-key-store-password</code>: key-store-password</li></ul></li><li><code>ksqldb</code>: <em>(optional list, define each ksqlDB instance as an element of a list)</em><ul><li><code>name</code>: ksqlDB name</li><li><code>url</code>: ksqlDB url</li><li><code>basic-auth-username</code>: ksqlDB basic auth username</li><li><code>basic-auth-password</code>: ksqlDB basic auth password</li></ul></li>",3),b=a(`<h2 id="basic-cluster-with-plain-auth" tabindex="-1"><a class="header-anchor" href="#basic-cluster-with-plain-auth" aria-hidden="true">#</a> Basic cluster with plain auth</h2><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">akhq</span><span class="token punctuation">:</span>
  <span class="token key atrule">connections</span><span class="token punctuation">:</span>
    <span class="token key atrule">local</span><span class="token punctuation">:</span>
      <span class="token key atrule">properties</span><span class="token punctuation">:</span>
        <span class="token key atrule">bootstrap.servers</span><span class="token punctuation">:</span> <span class="token string">&quot;local:9092&quot;</span>
      <span class="token key atrule">schema-registry</span><span class="token punctuation">:</span>
        <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">&quot;http://schema-registry:8085&quot;</span>
      <span class="token key atrule">connect</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;connect&quot;</span>
          <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">&quot;http://connect:8083&quot;</span>
      <span class="token key atrule">ksqldb</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;ksqldb&quot;</span>
          <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">&quot;http://connect:8088&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="example-for-confluent-cloud" tabindex="-1"><a class="header-anchor" href="#example-for-confluent-cloud" aria-hidden="true">#</a> Example for Confluent Cloud</h2><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">akhq</span><span class="token punctuation">:</span>
  <span class="token key atrule">connections</span><span class="token punctuation">:</span>
    <span class="token key atrule">ccloud</span><span class="token punctuation">:</span>
      <span class="token key atrule">properties</span><span class="token punctuation">:</span>
        <span class="token key atrule">bootstrap.servers</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ cluster }}.{{ region }}.{{ cloud }}.confluent.cloud:9092&quot;</span>
        <span class="token key atrule">security.protocol</span><span class="token punctuation">:</span> SASL_SSL
        <span class="token key atrule">sasl.mechanism</span><span class="token punctuation">:</span> PLAIN
        <span class="token key atrule">sasl.jaas.config</span><span class="token punctuation">:</span> org.apache.kafka.common.security.plain.PlainLoginModule required username=&quot;<span class="token punctuation">{</span><span class="token punctuation">{</span> kafkaUsername <span class="token punctuation">}</span><span class="token punctuation">}</span>&quot; password=&quot;<span class="token punctuation">{</span><span class="token punctuation">{</span> kafkaPassword <span class="token punctuation">}</span><span class="token punctuation">}</span>&quot;;
      <span class="token key atrule">schema-registry</span><span class="token punctuation">:</span>
        <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">&quot;https://{{ cluster }}.{{ region }}.{{ cloud }}.confluent.cloud&quot;</span>
        <span class="token key atrule">basic-auth-username</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ schemaRegistryUsername }}&quot;</span>
        <span class="token key atrule">basic-auth-password</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ schemaRegistryPaswword }}&quot;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ssl-kafka-cluster" tabindex="-1"><a class="header-anchor" href="#ssl-kafka-cluster" aria-hidden="true">#</a> SSL Kafka Cluster</h2><p>Configuration example for kafka cluster secured by ssl for saas provider like aiven (full https &amp; basic auth):</p><p>You need to generate a jks &amp; p12 file from pem, cert files give by saas provider.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>openssl pkcs12 <span class="token parameter variable">-export</span> <span class="token parameter variable">-inkey</span> service.key <span class="token parameter variable">-in</span> service.cert <span class="token parameter variable">-out</span> client.keystore.p12 <span class="token parameter variable">-name</span> service_key
keytool <span class="token parameter variable">-import</span> <span class="token parameter variable">-file</span> ca.pem <span class="token parameter variable">-alias</span> CA <span class="token parameter variable">-keystore</span> client.truststore.jks
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Configurations will look like this example:</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">akhq</span><span class="token punctuation">:</span>
  <span class="token key atrule">connections</span><span class="token punctuation">:</span>
    <span class="token key atrule">ssl-dev</span><span class="token punctuation">:</span>
      <span class="token key atrule">properties</span><span class="token punctuation">:</span>
        <span class="token key atrule">bootstrap.servers</span><span class="token punctuation">:</span> <span class="token string">&quot;{{host}}.aivencloud.com:12835&quot;</span>
        <span class="token key atrule">security.protocol</span><span class="token punctuation">:</span> SSL
        <span class="token key atrule">ssl.truststore.location</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token punctuation">}</span>/avnadmin.truststore.jks
        <span class="token key atrule">ssl.truststore.password</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>password<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">ssl.keystore.type</span><span class="token punctuation">:</span> <span class="token string">&quot;PKCS12&quot;</span>
        <span class="token key atrule">ssl.keystore.location</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token punctuation">}</span>/avnadmin.keystore.p12
        <span class="token key atrule">ssl.keystore.password</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>password<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">ssl.key.password</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>password<span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token key atrule">schema-registry</span><span class="token punctuation">:</span>
        <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">&quot;https://{{host}}.aivencloud.com:12838&quot;</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">&quot;confluent&quot;</span>
        <span class="token key atrule">basic-auth-username</span><span class="token punctuation">:</span> avnadmin
        <span class="token key atrule">basic-auth-password</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>password<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">properties</span><span class="token punctuation">:</span>
          <span class="token key atrule">schema.registry.ssl.truststore.location</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token punctuation">}</span>/avnadmin.truststore.jks
          <span class="token key atrule">schema.registry.ssl.truststore.password</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>password<span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token key atrule">connect</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> connect<span class="token punctuation">-</span><span class="token number">1</span>
          <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">&quot;https://{{host}}.aivencloud.com:{{port}}&quot;</span>
          <span class="token key atrule">basic-auth-username</span><span class="token punctuation">:</span> avnadmin
          <span class="token key atrule">basic-auth-password</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>password<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="oauth2-authentification-for-brokers" tabindex="-1"><a class="header-anchor" href="#oauth2-authentification-for-brokers" aria-hidden="true">#</a> OAuth2 authentification for brokers</h2><p>Requirement Library Strimzi:</p><blockquote><p>The kafka brokers must be configured with the Strimzi library and an OAuth2 provider (Keycloak example).</p></blockquote>`,13),y={href:"https://github.com/strimzi/strimzi-kafka-oauth",target:"_blank",rel:"noopener noreferrer"},f=a(`<p>Configuration Bootstrap:</p><blockquote><p>It&#39;s not necessary to compile AKHQ to integrate the Strimzi libraries since the libs will be included on the final image !</p></blockquote><p>You must configure AKHQ through the application.yml file.</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">akhq</span><span class="token punctuation">:</span>
  <span class="token key atrule">connections</span><span class="token punctuation">:</span>
    <span class="token key atrule">my-kafka-cluster</span><span class="token punctuation">:</span>
      <span class="token key atrule">properties</span><span class="token punctuation">:</span>
        <span class="token key atrule">bootstrap.servers</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;url broker kafka&gt;:9094,&lt;url broker kafka&gt;:9094&quot;</span>
        <span class="token key atrule">sasl.jaas.config</span><span class="token punctuation">:</span> org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginModule required auth.valid.issuer.uri=&quot;https<span class="token punctuation">:</span>//&lt;url keycloak<span class="token punctuation">&gt;</span>/auth/realms/sandbox_kafka&quot; oauth.jwks.endpoint.uri=&quot;https<span class="token punctuation">:</span>/&lt;url keycloak<span class="token punctuation">&gt;</span>//auth/realms/sandbox_kafka/protocol/openid<span class="token punctuation">-</span>connect/certs&quot; oauth.username.claim=&quot;preferred_username&quot; oauth.client.id=&quot;kafka<span class="token punctuation">-</span>producer<span class="token punctuation">-</span>client&quot; oauth.client.secret=&quot;&quot; oauth.ssl.truststore.location=&quot;kafka.server.truststore.jks&quot; oauth.ssl.truststore.password=&quot;xxxxx&quot; oauth.ssl.truststore.type=&quot;jks&quot; oauth.ssl.endpoint_identification_algorithm=&quot;&quot; oauth.token.endpoint.uri=&quot;https<span class="token punctuation">:</span>///auth/realms/sandbox_kafka/protocol/openid<span class="token punctuation">-</span>connect/token&quot;;
        <span class="token key atrule">sasl.login.callback.handler.class</span><span class="token punctuation">:</span> io.strimzi.kafka.oauth.client.JaasClientOauthLoginCallbackHandler
        <span class="token key atrule">security.protocol</span><span class="token punctuation">:</span> SASL_PLAINTEXT
        <span class="token key atrule">sasl.mechanism</span><span class="token punctuation">:</span> OAUTHBEARER
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>I put oauth.ssl.endpoint_identification_algorithm = &quot;&quot; for testing or my certificates did not match the FQDN. In a production, you have to remove it.</p>`,5);function g(q,_){const e=l("ExternalLinkIcon");return c(),p("div",null,[u,s("ul",null,[s("li",null,[r,n(" is a key value configuration with : "),s("ul",null,[k,s("li",null,[d,n(": all the configurations found on "),s("a",m,[n("Kafka consumer documentation"),t(e)]),n(". Most important is "),v,n(" that is a list of host:port of your Kafka brokers.")]),h])])]),b,s("blockquote",null,[s("p",null,[n("This "),s("a",y,[n("repository"),t(e)]),n(" contains documentation and examples.")])]),f])}const x=o(i,[["render",g],["__file","brokers.html.vue"]]);export{x as default};
