buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
        jcenter()
    }
    dependencies {
        classpath "com.moowork.gradle:gradle-node-plugin:1.3.1"
    }

}

apply plugin: 'com.moowork.node'

/**********************************************************************************************************************\
 * Node + Webpack
 **********************************************************************************************************************/
node {
    version = '6.10.2'
    npmVersion = '3.10.6'
    //workDir = file('client')
    //nodeModulesDir = file('client')
    download = false
}

//task build(type: NpmTask) {
//    args = ['run', 'build']
//}
//build.dependsOn(npm_install)
//
//
//task react(type: NpmTask, dependsOn: 'npmInstall') {
//    args = ['run','start']
//}

task webpack(type: NpmTask, dependsOn: 'npmInstall') {
    args = ['run','build']
}

task copyClientResources(dependsOn: 'webpack') {
    group = 'build'
    description = 'Copy client resources into server'
}

copyClientResources.doFirst {
    copy {
        from "build"
        into "../src/main/resources/static/ui/"
    }
}
//
//task assembleServerAndClient(dependsOn: ['copyClientResources']) {
//    group = 'build'
//    description = 'Build combined server & client JAR'
//}

//jar.dependsOn 'copyClientResources'
//processResources.dependsOn 'copyClientResources'

//clean.delete << file("src/main/resources/static")
